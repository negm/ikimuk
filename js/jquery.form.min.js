/*
 * jQuery Form Plugin
 * version: 3.18 (28-SEP-2012)
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
(function(a){"use strict";var c={};c.fileapi=a("<input type='file'/>").get(0).files!==undefined;c.formdata=window.FormData!==undefined;a.fn.ajaxSubmit=function(d){if(!this.length){b("ajaxSubmit: skipping submit process - no element selected");return this}var h,q,f,e=this;if(typeof d=="function")d={success:d};h=this.attr("method");q=this.attr("action");f=typeof q==="string"?a.trim(q):"";f=f||window.location.href||"";if(f)f=(f.match(/^([^#]+)/)||[])[1];d=a.extend(true,{url:f,success:a.ajaxSettings.success,type:h||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},d);var n={};this.trigger("form-pre-serialize",[this,d,n]);if(n.veto){b("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(d.beforeSerialize&&d.beforeSerialize(this,d)===false){b("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var m=d.traditional;if(m===undefined)m=a.ajaxSettings.traditional;var j=[],o,i=this.formToArray(d.semantic,j);if(d.data){d.extraData=d.data;o=a.param(d.data,m)}if(d.beforeSubmit&&d.beforeSubmit(i,this,d)===false){b("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[i,this,d,n]);if(n.veto){b("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var l=a.param(i,m);if(o)l=l?l+"&"+o:o;if(d.type.toUpperCase()=="GET"){d.url+=(d.url.indexOf("?")>=0?"&":"?")+l;d.data=null}else d.data=l;var g=[];d.resetForm&&g.push(function(){e.resetForm()});d.clearForm&&g.push(function(){e.clearForm(d.includeHidden)});if(!d.dataType&&d.target){var A=d.success||function(){};g.push(function(b){var c=d.replaceTarget?"replaceWith":"html";a(d.target)[c](b).each(A,arguments)})}else d.success&&g.push(d.success);d.success=function(f,c,i){for(var b=d.context||this,a=0,h=g.length;a<h;a++)g[a].apply(b,[f,c,i||e,e])};var z=a("input:file:enabled[value]",this),t=z.length>0,v="multipart/form-data",u=e.attr("enctype")==v||e.attr("encoding")==v,p=c.fileapi&&c.formdata;b("fileAPI :"+p);var w=(t||u)&&!p,k;if(d.iframe!==false&&(d.iframe||w))if(d.closeKeepAlive)a.get(d.closeKeepAlive,function(){k=s(i)});else k=s(i);else if((t||u)&&p)k=y(i);else k=a.ajax(d);e.removeData("jqxhr").data("jqxhr",k);for(var r=0;r<j.length;r++)j[r]=null;this.trigger("form-submit-notify",[this,d]);return this;function x(f){for(var d=a.param(f).split("&"),g=d.length,e={},b,c=0;c<g;c++){b=d[c].split("=");e[decodeURIComponent(b[0])]=decodeURIComponent(b[1])}return e}function y(g){for(var f=new FormData,c=0;c<g.length;c++)f.append(g[c].name,g[c].value);if(d.extraData){var e=x(d.extraData);for(var i in e)e.hasOwnProperty(i)&&f.append(i,e[i])}d.data=null;var b=a.extend(true,{},a.ajaxSettings,d,{contentType:false,processData:false,cache:false,type:h||"POST"});if(d.uploadProgress)b.xhr=function(){var a=jQuery.ajaxSettings.xhr();if(a.upload)a.upload.onprogress=function(a){var c=0,b=a.loaded||a.position,e=a.total;if(a.lengthComputable)c=Math.ceil(b/e*100);d.uploadProgress(a,b,e,c)};return a};b.data=null;var j=b.beforeSend;b.beforeSend=function(b,a){a.data=f;j&&j.call(this,b,a)};return a.ajax(b)}function s(J){var i=e[0],w,t,c,n,s,m,l,f,q,o,v,r,H=!!a.fn.prop,k=a.Deferred();if(a(":input[name=submit],:input[id=submit]",i).length){alert('Error: Form elements must not have name or id of "submit".');k.reject();return k}if(J)for(t=0;t<j.length;t++){w=a(j[t]);if(H)w.prop("disabled",false);else w.removeAttr("disabled")}c=a.extend(true,{},a.ajaxSettings,d);c.context=c.context||c;s="jqFormIO"+(new Date).getTime();if(c.iframeTarget){m=a(c.iframeTarget);o=m.attr("name");if(!o)m.attr("name",s);else s=o}else{m=a('<iframe name="'+s+'" src="'+c.iframeSrc+'" />');m.css({position:"absolute",top:"-1000px",left:"-1000px"})}l=m[0];f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var d=e==="timeout"?"timeout":"aborted";b("aborting upload... "+d);this.aborted=1;if(l.contentWindow.document.execCommand)try{l.contentWindow.document.execCommand("Stop")}catch(g){}m.attr("src",c.iframeSrc);f.error=d;c.error&&c.error.call(c.context,f,d,e);n&&a.event.trigger("ajaxError",[f,c,d]);c.complete&&c.complete.call(c.context,f,d)}};n=c.global;n&&0===a.active++&&a.event.trigger("ajaxStart");n&&a.event.trigger("ajaxSend",[f,c]);if(c.beforeSend&&c.beforeSend.call(c.context,f,c)===false){if(c.global)a.active--;k.reject();return k}if(f.aborted){k.reject();return k}q=i.clk;if(q){o=q.name;if(o&&!q.disabled){c.extraData=c.extraData||{};c.extraData[o]=q.value;if(q.type=="image"){c.extraData[o+".x"]=i.clk_x;c.extraData[o+".y"]=i.clk_y}}}var x=1,u=2;function C(a){return a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document}var A=a("meta[name=csrf-token]").attr("content"),z=a("meta[name=csrf-param]").attr("content");if(z&&A){c.extraData=c.extraData||{};c.extraData[z]=A}function B(){var k=e.attr("target"),j=e.attr("action");i.setAttribute("target",s);!h&&i.setAttribute("method","POST");j!=c.url&&i.setAttribute("action",c.url);!c.skipEncodingOverride&&(!h||/post/i.test(h))&&e.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(c.timeout)r=setTimeout(function(){v=true;p(x)},c.timeout);function g(){try{var a=C(l).readyState;b("state = "+a);a&&a.toLowerCase()=="uninitialized"&&setTimeout(g,50)}catch(c){b("Server abort: ",c," (",c.name,")");p(u);r&&clearTimeout(r);r=undefined}}var f=[];try{if(c.extraData)for(var d in c.extraData)if(c.extraData.hasOwnProperty(d))if(a.isPlainObject(c.extraData[d])&&c.extraData[d].hasOwnProperty("name")&&c.extraData[d].hasOwnProperty("value"))f.push(a('<input type="hidden" name="'+c.extraData[d].name+'">').attr("value",c.extraData[d].value).appendTo(i)[0]);else f.push(a('<input type="hidden" name="'+d+'">').attr("value",c.extraData[d]).appendTo(i)[0]);if(!c.iframeTarget){m.appendTo("body");if(l.attachEvent)l.attachEvent("onload",p);else l.addEventListener("load",p,false)}setTimeout(g,15);i.submit()}finally{i.setAttribute("action",j);if(k)i.setAttribute("target",k);else e.removeAttr("target");a(f).remove()}}if(c.forceSync)B();else setTimeout(B,10);var D,g,E=50,y;function p(t){if(f.aborted||y)return;try{g=C(l)}catch(z){b("cannot access response document: ",z);t=u}if(t===x&&f){f.abort("timeout");k.reject(f,"timeout");return}else if(t==u&&f){f.abort("server abort");k.reject(f,"error","server abort");return}if(!g||g.location.href==c.iframeSrc)if(!v)return;if(l.detachEvent)l.detachEvent("onload",p);else l.removeEventListener("load",p,false);var d="success",e;try{if(v)throw"timeout";var q=c.dataType=="xml"||g.XMLDocument||a.isXMLDoc(g);b("isXml="+q);if(!q&&window.opera&&(g.body===null||!g.body.innerHTML))if(--E){b("requeing onLoad callback, DOM not available");setTimeout(p,250);return}var h=g.body?g.body:g.documentElement;f.responseText=h?h.innerHTML:null;f.responseXML=g.XMLDocument?g.XMLDocument:g;if(q)c.dataType="xml";f.getResponseHeader=function(b){var a={"content-type":c.dataType};return a[b]};if(h){f.status=Number(h.getAttribute("status"))||f.status;f.statusText=h.getAttribute("statusText")||f.statusText}var s=(c.dataType||"").toLowerCase(),w=/(json|script|text)/.test(s);if(w||c.textarea){var j=g.getElementsByTagName("textarea")[0];if(j){f.responseText=j.value;f.status=Number(j.getAttribute("status"))||f.status;f.statusText=j.getAttribute("statusText")||f.statusText}else if(w){var i=g.getElementsByTagName("pre")[0],o=g.getElementsByTagName("body")[0];if(i)f.responseText=i.textContent?i.textContent:i.innerText;else if(o)f.responseText=o.textContent?o.textContent:o.innerText}}else if(s=="xml"&&!f.responseXML&&f.responseText)f.responseXML=I(f.responseText);try{D=G(f,s,c)}catch(t){d="parsererror";f.error=e=t||d}}catch(t){b("error caught: ",t);d="error";f.error=e=t||d}if(f.aborted){b("upload aborted");d=null}if(f.status)d=f.status>=200&&f.status<300||f.status===304?"success":"error";if(d==="success"){c.success&&c.success.call(c.context,D,"success",f);k.resolve(f.responseText,"success",f);n&&a.event.trigger("ajaxSuccess",[f,c])}else if(d){if(e===undefined)e=f.statusText;c.error&&c.error.call(c.context,f,d,e);k.reject(f,"error",e);n&&a.event.trigger("ajaxError",[f,c,e])}n&&a.event.trigger("ajaxComplete",[f,c]);n&&!--a.active&&a.event.trigger("ajaxStop");c.complete&&c.complete.call(c.context,f,d);y=true;c.timeout&&clearTimeout(r);setTimeout(function(){!c.iframeTarget&&m.remove();f.responseXML=null},100)}var I=a.parseXML||function(b,a){if(window.ActiveXObject){a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b)}else a=(new DOMParser).parseFromString(b,"text/xml");return a&&a.documentElement&&a.documentElement.nodeName!="parsererror"?a:null},F=a.parseJSON||function(a){return window.eval("("+a+")")},G=function(d,c,f){var e=d.getResponseHeader("content-type")||"",g=c==="xml"||!c&&e.indexOf("xml")>=0,b=g?d.responseXML:d.responseText;if(g&&b.documentElement.nodeName==="parsererror")a.error&&a.error("parsererror");if(f&&f.dataFilter)b=f.dataFilter(b,c);if(typeof b==="string")if(c==="json"||!c&&e.indexOf("json")>=0)b=F(b);else(c==="script"||!c&&e.indexOf("javascript")>=0)&&a.globalEval(b);return b};return k}};a.fn.ajaxForm=function(c){c=c||{};c.delegation=c.delegation&&a.isFunction(a.fn.on);if(!c.delegation&&this.length===0){var f={s:this.selector,c:this.context};if(!a.isReady&&f.s){b("DOM not ready, queuing ajaxForm");a(function(){a(f.s,f.c).ajaxForm(c)});return this}b("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)"));return this}if(c.delegation){a(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,d).on("submit.form-plugin",this.selector,c,e).on("click.form-plugin",this.selector,c,d);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",c,e).bind("click.form-plugin",c,d)};function e(b){var c=b.data;if(!b.isDefaultPrevented()){b.preventDefault();a(this).ajaxSubmit(c)}}function d(c){var d=c.target,e=a(d);if(!e.is(":submit,input:image")){var g=e.closest(":submit");if(g.length===0)return;d=g[0]}var b=this;b.clk=d;if(d.type=="image")if(c.offsetX!==undefined){b.clk_x=c.offsetX;b.clk_y=c.offsetY}else if(typeof a.fn.offset=="function"){var f=e.offset();b.clk_x=c.pageX-f.left;b.clk_y=c.pageY-f.top}else{b.clk_x=c.pageX-d.offsetLeft;b.clk_y=c.pageY-d.offsetTop}setTimeout(function(){b.clk=b.clk_x=b.clk_y=null},100)}a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};a.fn.formToArray=function(k,i){var e=[];if(this.length===0)return e;var f=this[0],n=k?f.getElementsByTagName("*"):f.elements;if(!n)return e;var j,g,d,h,b,q,p;for(j=0,q=n.length;j<q;j++){b=n[j];d=b.name;if(!d)continue;if(k&&f.clk&&b.type=="image"){if(!b.disabled&&f.clk==b){e.push({name:d,value:a(b).val(),type:b.type});e.push({name:d+".x",value:f.clk_x},{name:d+".y",value:f.clk_y})}continue}h=a.fieldValue(b,true);if(h&&h.constructor==Array){i&&i.push(b);for(g=0,p=h.length;g<p;g++)e.push({name:d,value:h[g]})}else if(c.fileapi&&b.type=="file"&&!b.disabled){i&&i.push(b);var l=b.files;if(l.length)for(g=0;g<l.length;g++)e.push({name:d,value:l[g],type:b.type});else e.push({name:d,value:"",type:b.type})}else if(h!==null&&typeof h!="undefined"){i&&i.push(b);e.push({name:d,value:h,type:b.type,required:b.required})}}if(!k&&f.clk){var o=a(f.clk),m=o[0];d=m.name;if(d&&!m.disabled&&m.type=="image"){e.push({name:d,value:o.val()});e.push({name:d+".x",value:f.clk_x},{name:d+".y",value:f.clk_y})}}return e};a.fn.formSerialize=function(b){return a.param(this.formToArray(b))};a.fn.fieldSerialize=function(c){var b=[];this.each(function(){var f=this.name;if(!f)return;var d=a.fieldValue(this,c);if(d&&d.constructor==Array)for(var e=0,g=d.length;e<g;e++)b.push({name:f,value:d[e]});else d!==null&&typeof d!="undefined"&&b.push({name:this.name,value:d})});return a.param(b)};a.fn.fieldValue=function(e){for(var c=[],d=0,f=this.length;d<f;d++){var g=this[d],b=a.fieldValue(g,e);if(b===null||typeof b=="undefined"||b.constructor==Array&&!b.length)continue;if(b.constructor==Array)a.merge(c,b);else c.push(b)}return c};a.fieldValue=function(b,f){var n=b.name,d=b.type,k=b.tagName.toLowerCase();if(f===undefined)f=true;if(f&&(!n||b.disabled||d=="reset"||d=="button"||(d=="checkbox"||d=="radio")&&!b.checked||(d=="submit"||d=="image")&&b.form&&b.form.clk!=b||k=="select"&&b.selectedIndex==-1))return null;if(k=="select"){var g=b.selectedIndex;if(g<0)return null;for(var l=[],j=b.options,h=d=="select-one",m=h?g+1:j.length,i=h?g:0;i<m;i++){var c=j[i];if(c.selected){var e=c.value;if(!e)e=c.attributes&&c.attributes.value&&!c.attributes.value.specified?c.text:c.value;if(h)return e;l.push(e)}}return l}return a(b).val()};a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})};a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();if(c.test(d)||e=="textarea")this.value="";else if(d=="checkbox"||d=="radio")this.checked=false;else if(e=="select")this.selectedIndex=-1;else if(b)if(b===true&&/hidden/.test(d)||typeof b=="string"&&a(this).is(b))this.value=""})};a.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};a.fn.enable=function(a){if(a===undefined)a=true;return this.each(function(){this.disabled=!a})};a.fn.selected=function(b){if(b===undefined)b=true;return this.each(function(){var d=this.type;if(d=="checkbox"||d=="radio")this.checked=b;else if(this.tagName.toLowerCase()=="option"){var c=a(this).parent("select");b&&c[0]&&c[0].type=="select-one"&&c.find("option").selected(false);this.selected=b}})};a.fn.ajaxSubmit.debug=false;function b(){if(!a.fn.ajaxSubmit.debug)return;var b="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log)window.console.log(b);else window.opera&&window.opera.postError&&window.opera.postError(b)}})(jQuery)